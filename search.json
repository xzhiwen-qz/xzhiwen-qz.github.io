[{"title":"Steam令牌码生成","url":"/archives/63555b67","content":"import hashlibimport hmacimport structfrom base64 import b64decodefrom time import timedef get_steam_auth_code(secret: str, t: int = None) -&gt; str:    if not t:        t = int(time() / 30)    msg = struct.pack(&quot;&gt;Q&quot;, t)    key = b64decode(secret)    mac = hmac.new(key, msg, hashlib.sha1).digest()    offset = mac[-1] &amp; 0x0f    binary = struct.unpack(&#x27;&gt;L&#x27;, mac[offset:offset + 4])[0] &amp; 0x7fffffff    codestr = list(&#x27;23456789BCDFGHJKMNPQRTVWXY&#x27;)    chars = []    for _ in range(5):        chars.append(codestr[binary % 26])        binary //= 26    code = &#x27;&#x27;.join(chars)    return codeprint(get_steam_auth_code(&#x27;你的密钥&#x27;, ))\n","categories":["技术"],"tags":["Python"]}]